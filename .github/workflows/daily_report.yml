name: Daily Automation Master

on:
  schedule:
    - cron: '0 0 * * *'  # ë§¤ì¼ ì˜¤ì „ 9ì‹œ (KST = UTC+9)
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼

jobs:
  run-all-tasks:
    runs-on: ubuntu-latest
    
    env:
      # [ê³µí†µ] Claude & Email
      ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
      GMAIL_APP_PASSWORD: ${{ secrets.GMAIL_APP_PASSWORD }}
      
      # [ë¦¬í¬íŠ¸ìš©] ë„¤ì´ë²„ í‚¤
      NAVER_CLIENT_ID: ${{ secrets.NAVER_CLIENT_ID }}
      NAVER_CLIENT_SECRET: ${{ secrets.NAVER_CLIENT_SECRET }}
      NAVER_CLIENT_ID_PACSAFE: ${{ secrets.NAVER_CLIENT_ID_PACSAFE }}
      NAVER_CLIENT_SECRET_PACSAFE: ${{ secrets.NAVER_CLIENT_SECRET_PACSAFE }}
      
      # [Optimusìš©] ë„¤ì´ë²„ í‚¤ & êµ¬ê¸€ì‹œíŠ¸
      GCP_SA_KEY: ${{ secrets.GCP_SA_KEY }}
      OP_ID_PACSAFE: ${{ secrets.OP_ID_PACSAFE }}
      OP_PW_PACSAFE: ${{ secrets.OP_PW_PACSAFE }}
      SHEET_ID_PACSAFE: ${{ secrets.SHEET_ID_PACSAFE }}
      OP_ID_PRESIDENT: ${{ secrets.OP_ID_PRESIDENT }}
      OP_PW_PRESIDENT: ${{ secrets.OP_PW_PRESIDENT }}
      SHEET_ID_PRESIDENT: ${{ secrets.SHEET_ID_PRESIDENT }}
    
    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4
      
      - name: ğŸ Python ì„¤ì •
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
        run: |
          pip install --upgrade pip
          pip install requests bcrypt anthropic gspread oauth2client
      
      # === ì´ë©”ì¼ ë¦¬í¬íŠ¸ (AI ë¶„ì„) ===
      
      - name: ğŸ“Š í”„ë ˆì§€ë˜íŠ¸ ì´ë©”ì¼ ë¦¬í¬íŠ¸
        run: python president_report.py
        continue-on-error: true
      
      - name: ğŸ“Š íŒ©ì„¸ì´í”„ ì´ë©”ì¼ ë¦¬í¬íŠ¸
        run: python pacsafe_report.py
        continue-on-error: true
      
      # === Optimus ë°ì´í„° ìˆ˜ì§‘ (êµ¬ê¸€ì‹œíŠ¸) ===
      
      - name: ğŸ“ˆ Optimus íŒ©ì„¸ì´í”„ ë°ì´í„° ìˆ˜ì§‘
        run: python optimus_pacsafe.py
        continue-on-error: true
      
      - name: ğŸ“ˆ Optimus í”„ë ˆì§€ë˜íŠ¸ ë°ì´í„° ìˆ˜ì§‘
        run: python optimus_president.py
        continue-on-error: true
      
      - name: âœ… ì‘ì—… ì™„ë£Œ
        run: echo "ğŸ‰ ëª¨ë“  ìë™í™” ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
